(function(e){if(typeof exports=="object"&&typeof module=="object")e(require("../../lib/codemirror"),require("./foldcode"));else if(typeof define=="function"&&define.amd)define(["../../lib/codemirror","./foldcode"],e);else e(CodeMirror)})(function(e){"use strict";function n(e){this.options=e;this.from=this.to=0}function r(e){if(e===true)e={};if(e.gutter==null)e.gutter="CodeMirror-foldgutter";if(e.indicatorOpen==null)e.indicatorOpen="CodeMirror-foldgutter-open";if(e.indicatorFolded==null)e.indicatorFolded="CodeMirror-foldgutter-folded";return e}function i(e,n){var r=e.findMarksAt(t(n));for(var i=0;i<r.length;++i)if(r[i].__isFold&&r[i].find().from.line==n)return true}function s(e){if(typeof e=="string"){var t=document.createElement("div");t.className=e;return t}else{return e.cloneNode(true)}}function o(n,r,o){var u=n.state.foldGutter.options,a=r;n.eachLine(r,o,function(r){var o=null;if(i(n,a)){o=s(u.indicatorFolded)}else{var f=t(a,0),l=u.rangeFinder||e.fold.auto;var c=l&&l(n,f);if(c&&c.from.line+1<c.to.line)o=s(u.indicatorOpen)}n.setGutterMarker(r,u.gutter,o);++a})}function u(e){var t=e.getViewport(),n=e.state.foldGutter;if(!n)return;e.operation(function(){o(e,t.from,t.to)});n.from=t.from;n.to=t.to}function a(e,n,r){var i=e.state.foldGutter.options;if(r!=i.gutter)return;e.foldCode(t(n,0),i.rangeFinder)}function f(e){var t=e.state.foldGutter,n=e.state.foldGutter.options;t.from=t.to=0;clearTimeout(t.changeUpdate);t.changeUpdate=setTimeout(function(){u(e)},n.foldOnChangeTimeSpan||600)}function l(e){var t=e.state.foldGutter,n=e.state.foldGutter.options;clearTimeout(t.changeUpdate);t.changeUpdate=setTimeout(function(){var n=e.getViewport();if(t.from==t.to||n.from-t.to>20||t.from-n.to>20){u(e)}else{e.operation(function(){if(n.from<t.from){o(e,n.from,t.from);t.from=n.from}if(n.to>t.to){o(e,t.to,n.to);t.to=n.to}})}},n.updateViewportTimeSpan||400)}function c(e,t){var n=e.state.foldGutter,r=t.line;if(r>=n.from&&r<n.to)o(e,r,r+1)}e.defineOption("foldGutter",false,function(t,i,s){if(s&&s!=e.Init){t.clearGutter(t.state.foldGutter.options.gutter);t.state.foldGutter=null;t.off("gutterClick",a);t.off("change",f);t.off("viewportChange",l);t.off("fold",c);t.off("unfold",c);t.off("swapDoc",u)}if(i){t.state.foldGutter=new n(r(i));u(t);t.on("gutterClick",a);t.on("change",f);t.on("viewportChange",l);t.on("fold",c);t.on("unfold",c);t.on("swapDoc",u)}});var t=e.Pos})