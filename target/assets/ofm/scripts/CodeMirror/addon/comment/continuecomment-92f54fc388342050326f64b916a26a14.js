(function(e){if(typeof exports=="object"&&typeof module=="object")e(require("../../lib/codemirror"));else if(typeof define=="function"&&define.amd)define(["../../lib/codemirror"],e);else e(CodeMirror)})(function(e){function r(t){if(t.getOption("disableInput"))return e.Pass;var n=t.listSelections(),r,s=[];for(var o=0;o<n.length;o++){var u=n[o].head,a=t.getTokenAt(u);if(a.type!="comment")return e.Pass;var f=e.innerMode(t.getMode(),a.state).mode;if(!r)r=f;else if(r!=f)return e.Pass;var l=null;if(r.blockCommentStart&&r.blockCommentContinue){var c=a.string.indexOf(r.blockCommentEnd);var h=t.getRange(e.Pos(u.line,0),e.Pos(u.line,a.end)),p;if(c!=-1&&c==a.string.length-r.blockCommentEnd.length&&u.ch>=c){}else if(a.string.indexOf(r.blockCommentStart)==0){l=h.slice(0,a.start);if(!/^\s*$/.test(l)){l="";for(var d=0;d<a.start;++d)l+=" "}}else if((p=h.indexOf(r.blockCommentContinue))!=-1&&p+r.blockCommentContinue.length>a.start&&/^\s*$/.test(h.slice(0,p))){l=h.slice(0,p)}if(l!=null)l+=r.blockCommentContinue}if(l==null&&r.lineComment&&i(t)){var v=t.getLine(u.line),p=v.indexOf(r.lineComment);if(p>-1){l=v.slice(0,p);if(/\S/.test(l))l=null;else l+=r.lineComment+v.slice(p+r.lineComment.length).match(/^\s*/)[0]}}if(l==null)return e.Pass;s[o]="\n"+l}t.operation(function(){for(var e=n.length-1;e>=0;e--)t.replaceRange(s[e],n[e].from(),n[e].to(),"+insert")})}function i(e){var t=e.getOption("continueComments");if(t&&typeof t=="object")return t.continueLineComment!==false;return true}var t=["clike","css","javascript"];for(var n=0;n<t.length;++n)e.extendMode(t[n],{blockCommentContinue:" * "});e.defineOption("continueComments",null,function(t,n,i){if(i&&i!=e.Init)t.removeKeyMap("continueComment");if(n){var s="Enter";if(typeof n=="string")s=n;else if(typeof n=="object"&&n.key)s=n.key;var o={name:"continueComment"};o[s]=r;t.addKeyMap(o)}})})