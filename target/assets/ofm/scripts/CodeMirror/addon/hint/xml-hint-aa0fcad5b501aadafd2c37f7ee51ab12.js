(function(e){if(typeof exports=="object"&&typeof module=="object")e(require("../../lib/codemirror"));else if(typeof define=="function"&&define.amd)define(["../../lib/codemirror"],e);else e(CodeMirror)})(function(e){"use strict";function n(n,r){var i=r&&r.schemaInfo;var s=r&&r.quoteChar||'"';if(!i)return;var o=n.getCursor(),u=n.getTokenAt(o);var a=e.innerMode(n.getMode(),u.state);if(a.mode.name!="xml")return;var f=[],l=false,c;var h=/\btag\b/.test(u.type),p=h&&/^\w/.test(u.string),d;if(p){var v=n.getLine(o.line).slice(Math.max(0,u.start-2),u.start);var m=/<\/$/.test(v)?"close":/<$/.test(v)?"open":null;if(m)d=u.start-(m=="close"?2:1)}else if(h&&u.string=="<"){m="open"}else if(h&&u.string=="</"){m="close"}if(!h&&!a.state.tagName||m){if(p)c=u.string;l=m;var g=a.state.context,y=g&&i[g.tagName];var b=g?y&&y.children:i["!top"];if(b&&m!="close"){for(var w=0;w<b.length;++w)if(!c||b[w].lastIndexOf(c,0)==0)f.push("<"+b[w])}else if(m!="close"){for(var E in i)if(i.hasOwnProperty(E)&&E!="!top"&&(!c||E.lastIndexOf(c,0)==0))f.push("<"+E)}if(g&&(!c||m=="close"&&g.tagName.lastIndexOf(c,0)==0))f.push("</"+g.tagName+">")}else{var y=i[a.state.tagName],S=y&&y.attrs;if(!S)return;if(u.type=="string"||u.string=="="){var v=n.getRange(t(o.line,Math.max(0,o.ch-60)),t(o.line,u.type=="string"?u.start:u.end));var x=v.match(/([^\s\u00a0=<>\"\']+)=$/),T;if(!x||!S.hasOwnProperty(x[1])||!(T=S[x[1]]))return;if(typeof T=="function")T=T.call(this,n);if(u.type=="string"){c=u.string;if(/['"]/.test(u.string.charAt(0))){s=u.string.charAt(0);c=u.string.slice(1)}l=true}for(var w=0;w<T.length;++w)if(!c||T[w].lastIndexOf(c,0)==0)f.push(s+T[w]+s)}else{if(u.type=="attribute"){c=u.string;l=true}for(var N in S)if(S.hasOwnProperty(N)&&(!c||N.lastIndexOf(c,0)==0))f.push(N)}}return{list:f,from:l?t(o.line,d==null?u.start:d):o,to:l?t(o.line,u.end):o}}var t=e.Pos;e.registerHelper("hint","xml",n)})