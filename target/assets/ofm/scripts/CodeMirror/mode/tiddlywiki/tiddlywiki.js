(function(e){if(typeof exports=="object"&&typeof module=="object")e(require("../../lib/codemirror"));else if(typeof define=="function"&&define.amd)define(["../../lib/codemirror"],e);else e(CodeMirror)})(function(e){"use strict";e.defineMode("tiddlywiki",function(){function d(e,t,n){t.tokenize=n;return n(e,t)}function g(e,t,n){v=e;m=n;return t}function y(t,h){var p=t.sol(),v;h.block=false;v=t.peek();if(p&&/[<\/\*{}\-]/.test(v)){if(t.match(c)){h.block=true;return d(t,h,E)}if(t.match(o)){return g("quote","quote")}if(t.match(i)||t.match(s)){return g("code","comment")}if(t.match(u)||t.match(a)||t.match(f)||t.match(l)){return g("code","comment")}if(t.match(r)){return g("hr","hr")}}v=t.next();if(p&&/[\/\*!#;:>|]/.test(v)){if(v=="!"){t.skipToEnd();return g("header","header")}if(v=="*"){t.eatWhile("*");return g("list","comment")}if(v=="#"){t.eatWhile("#");return g("list","comment")}if(v==";"){t.eatWhile(";");return g("list","comment")}if(v==":"){t.eatWhile(":");return g("list","comment")}if(v==">"){t.eatWhile(">");return g("quote","quote")}if(v=="|"){return g("table","header")}}if(v=="{"&&t.match(/\{\{/)){return d(t,h,E)}if(/[hf]/i.test(v)){if(/[ti]/i.test(t.peek())&&t.match(/\b(ttps?|tp|ile):\/\/[\-A-Z0-9+&@#\/%?=~_|$!:,.;]*[A-Z0-9+&@#\/%=~_|$]/i)){return g("link","link")}}if(v=='"'){return g("string","string")}if(v=="~"){return g("text","brace")}if(/[\[\]]/.test(v)){if(t.peek()==v){t.next();return g("brace","brace")}}if(v=="@"){t.eatWhile(n);return g("link","link")}if(/\d/.test(v)){t.eatWhile(/\d/);return g("number","number")}if(v=="/"){if(t.eat("%")){return d(t,h,b)}else if(t.eat("/")){return d(t,h,S)}}if(v=="_"){if(t.eat("_")){return d(t,h,x)}}if(v=="-"){if(t.eat("-")){if(t.peek()!=" ")return d(t,h,T);if(t.peek()==" ")return g("text","brace")}}if(v=="'"){if(t.eat("'")){return d(t,h,w)}}if(v=="<"){if(t.eat("<")){return d(t,h,N)}}else{return g(v)}t.eatWhile(/[\w\$_]/);var m=t.current(),y=e.propertyIsEnumerable(m)&&e[m];return y?g(y.type,y.style,m):g("text",null,m)}function b(e,t){var n=false,r;while(r=e.next()){if(r=="/"&&n){t.tokenize=y;break}n=r=="%"}return g("comment","comment")}function w(e,t){var n=false,r;while(r=e.next()){if(r=="'"&&n){t.tokenize=y;break}n=r=="'"}return g("text","strong")}function E(e,t){var n,r=t.block;if(r&&e.current()){return g("code","comment")}if(!r&&e.match(p)){t.tokenize=y;return g("code","comment")}if(r&&e.sol()&&e.match(h)){t.tokenize=y;return g("code","comment")}n=e.next();return r?g("code","comment"):g("code","comment")}function S(e,t){var n=false,r;while(r=e.next()){if(r=="/"&&n){t.tokenize=y;break}n=r=="/"}return g("text","em")}function x(e,t){var n=false,r;while(r=e.next()){if(r=="_"&&n){t.tokenize=y;break}n=r=="_"}return g("text","underlined")}function T(e,t){var n=false,r;while(r=e.next()){if(r=="-"&&n){t.tokenize=y;break}n=r=="-"}return g("text","strikethrough")}function N(e,n){var r,i,s;if(e.current()=="<<"){return g("brace","macro")}r=e.next();if(!r){n.tokenize=y;return g(r)}if(r==">"){if(e.peek()==">"){e.next();n.tokenize=y;return g("brace","macro")}}e.eatWhile(/[\w\$_]/);i=e.current();s=t.propertyIsEnumerable(i)&&t[i];if(s){return g(s.type,s.style,i)}else{return g("macro",null,i)}}var e={};var t=function(){function e(e){return{type:e,style:"macro"}}return{allTags:e("allTags"),closeAll:e("closeAll"),list:e("list"),newJournal:e("newJournal"),newTiddler:e("newTiddler"),permaview:e("permaview"),saveChanges:e("saveChanges"),search:e("search"),slider:e("slider"),tabs:e("tabs"),tag:e("tag"),tagging:e("tagging"),tags:e("tags"),tiddler:e("tiddler"),timeline:e("timeline"),today:e("today"),version:e("version"),option:e("option"),"with":e("with"),filter:e("filter")}}();var n=/[\w_\-]/i,r=/^\-\-\-\-+$/,i=/^\/\*\*\*$/,s=/^\*\*\*\/$/,o=/^<<<$/,u=/^\/\/\{\{\{$/,a=/^\/\/\}\}\}$/,f=/^<!--\{\{\{-->$/,l=/^<!--\}\}\}-->$/,c=/^\{\{\{$/,h=/^\}\}\}$/,p=/.*?\}\}\}/;var v,m;return{startState:function(){return{tokenize:y,indented:0,level:0}},token:function(e,t){if(e.eatSpace())return null;var n=t.tokenize(e,t);return n},electricChars:""}});e.defineMIME("text/x-tiddlywiki","tiddlywiki")})