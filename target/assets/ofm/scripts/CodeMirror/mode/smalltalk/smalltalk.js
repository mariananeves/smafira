(function(e){if(typeof exports=="object"&&typeof module=="object")e(require("../../lib/codemirror"));else if(typeof define=="function"&&define.amd)define(["../../lib/codemirror"],e);else e(CodeMirror)})(function(e){"use strict";e.defineMode("smalltalk",function(e){var t=/[+\-\/\\*~<>=@%|&?!.,:;^]/;var n=/true|false|nil|self|super|thisContext/;var r=function(e,t){this.next=e;this.parent=t};var i=function(e,t,n){this.name=e;this.context=t;this.eos=n};var s=function(){this.context=new r(o,null);this.expectVariable=true;this.indentation=0;this.userIndentationDelta=0};s.prototype.userIndent=function(t){this.userIndentationDelta=t>0?t/e.indentUnit-this.indentation:0};var o=function(e,s,o){var c=new i(null,s,false);var h=e.next();if(h==='"'){c=u(e,new r(u,s))}else if(h==="'"){c=a(e,new r(a,s))}else if(h==="#"){if(e.peek()==="'"){e.next();c=f(e,new r(f,s))}else{if(e.eatWhile(/[^ .{}\[\]()]/))c.name="string-2";else c.name="meta"}}else if(h==="$"){if(e.next()==="<"){e.eatWhile(/[^ >]/);e.next()}c.name="string-2"}else if(h==="|"&&o.expectVariable){c.context=new r(l,s)}else if(/[\[\]{}()]/.test(h)){c.name="bracket";c.eos=/[\[{(]/.test(h);if(h==="["){o.indentation++}else if(h==="]"){o.indentation=Math.max(0,o.indentation-1)}}else if(t.test(h)){e.eatWhile(t);c.name="operator";c.eos=h!==";"}else if(/\d/.test(h)){e.eatWhile(/[\w\d]/);c.name="number"}else if(/[\w_]/.test(h)){e.eatWhile(/[\w\d_]/);c.name=o.expectVariable?n.test(e.current())?"keyword":"variable":null}else{c.eos=o.expectVariable}return c};var u=function(e,t){e.eatWhile(/[^"]/);return new i("comment",e.eat('"')?t.parent:t,true)};var a=function(e,t){e.eatWhile(/[^']/);return new i("string",e.eat("'")?t.parent:t,false)};var f=function(e,t){e.eatWhile(/[^']/);return new i("string-2",e.eat("'")?t.parent:t,false)};var l=function(e,t){var n=new i(null,t,false);var r=e.next();if(r==="|"){n.context=t.parent;n.eos=true}else{e.eatWhile(/[^|]/);n.name="variable"}return n};return{startState:function(){return new s},token:function(e,t){t.userIndent(e.indentation());if(e.eatSpace()){return null}var n=t.context.next(e,t.context,t);t.context=n.context;t.expectVariable=n.eos;return n.name},blankLine:function(e){e.userIndent(0)},indent:function(t,n){var r=t.context.next===o&&n&&n.charAt(0)==="]"?-1:t.userIndentationDelta;return(t.indentation+r)*e.indentUnit},electricChars:"]"}});e.defineMIME("text/x-stsrc",{name:"smalltalk"})})