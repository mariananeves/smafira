(function(e){if(typeof exports=="object"&&typeof module=="object")e(require("../../lib/codemirror"));else if(typeof define=="function"&&define.amd)define(["../../lib/codemirror"],e);else e(CodeMirror)})(function(e){"use strict";e.defineMode("stex",function(){"use strict";function e(e,t){e.cmdState.push(t)}function t(e){if(e.cmdState.length>0){return e.cmdState[e.cmdState.length-1]}else{return null}}function n(e){var t=e.cmdState.pop();if(t){t.closeBracket()}}function r(e){var t=e.cmdState;for(var n=t.length-1;n>=0;n--){var r=t[n];if(r.name=="DEFAULT"){continue}return r}return{styleIdentifier:function(){return null}}}function i(e,t,n){return function(){this.name=e;this.bracketNo=0;this.style=t;this.styles=n;this.argument=null;this.styleIdentifier=function(){return this.styles[this.bracketNo-1]||null};this.openBracket=function(){this.bracketNo++;return"bracket"};this.closeBracket=function(){}}}function o(e,t){e.f=t}function u(n,i){var u;if(n.match(/^\\[a-zA-Z@]+/)){var c=n.current().slice(1);u=s[c]||s["DEFAULT"];u=new u;e(i,u);o(i,l);return u.style}if(n.match(/^\\[$&%#{}_]/)){return"tag"}if(n.match(/^\\[,;!\/\\]/)){return"tag"}if(n.match("\\[")){o(i,function(e,t){return f(e,t,"\\]")});return"keyword"}if(n.match("$$")){o(i,function(e,t){return f(e,t,"$$")});return"keyword"}if(n.match("$")){o(i,function(e,t){return f(e,t,"$")});return"keyword"}var h=n.next();if(h=="%"){if(!n.eol()){o(i,a)}return"comment"}else if(h=="}"||h=="]"){u=t(i);if(u){u.closeBracket(h);o(i,l)}else{return"error"}return"bracket"}else if(h=="{"||h=="["){u=s["DEFAULT"];u=new u;e(i,u);return"bracket"}else if(/\d/.test(h)){n.eatWhile(/[\w.%]/);return"atom"}else{n.eatWhile(/[\w\-_]/);u=r(i);if(u.name=="begin"){u.argument=n.current()}return u.styleIdentifier()}}function a(e,t){e.skipToEnd();o(t,u);return"comment"}function f(e,t,n){if(e.eatSpace()){return null}if(e.match(n)){o(t,u);return"keyword"}if(e.match(/^\\[a-zA-Z@]+/)){return"tag"}if(e.match(/^[a-zA-Z]+/)){return"variable-2"}if(e.match(/^\\[$&%#{}_]/)){return"tag"}if(e.match(/^\\[,;!\/]/)){return"tag"}if(e.match(/^[\^_&]/)){return"tag"}if(e.match(/^[+\-<>|=,\/@!*:;'"`~#?]/)){return null}if(e.match(/^(\d+\.\d*|\d*\.\d+|\d+)/)){return"number"}var r=e.next();if(r=="{"||r=="}"||r=="["||r=="]"||r=="("||r==")"){return"bracket"}if(r=="%"){if(!e.eol()){e.skipToEnd()}return"comment"}return"error"}function l(e,r){var i=e.peek(),s;if(i=="{"||i=="["){s=t(r);s.openBracket(i);e.eat(i);o(r,u);return"bracket"}if(/[ \t\r]/.test(i)){e.eat(i);return null}o(r,u);n(r);return u(e,r)}var s={};s["importmodule"]=i("importmodule","tag",["string","builtin"]);s["documentclass"]=i("documentclass","tag",["","atom"]);s["usepackage"]=i("usepackage","tag",["atom"]);s["begin"]=i("begin","tag",["atom"]);s["end"]=i("end","tag",["atom"]);s["DEFAULT"]=function(){this.name="DEFAULT";this.style="tag";this.styleIdentifier=this.openBracket=this.closeBracket=function(){}};return{startState:function(){return{cmdState:[],f:u}},copyState:function(e){return{cmdState:e.cmdState.slice(),f:e.f}},token:function(e,t){return t.f(e,t)}}});e.defineMIME("text/x-stex","stex");e.defineMIME("text/x-latex","stex")})