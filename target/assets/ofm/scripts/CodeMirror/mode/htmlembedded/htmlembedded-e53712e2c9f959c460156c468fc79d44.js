(function(e){if(typeof exports=="object"&&typeof module=="object")e(require("../../lib/codemirror"),require("../htmlmixed/htmlmixed"));else if(typeof define=="function"&&define.amd)define(["../../lib/codemirror","../htmlmixed/htmlmixed"],e);else e(CodeMirror)})(function(e){"use strict";e.defineMode("htmlembedded",function(t,n){function u(e,t){if(e.match(r,false)){t.token=a;return s.token(e,t.scriptState)}else return o.token(e,t.htmlState)}function a(e,t){if(e.match(i,false)){t.token=u;return o.token(e,t.htmlState)}else return s.token(e,t.scriptState)}var r=n.scriptStartRegex||/^<%/i,i=n.scriptEndRegex||/^%>/i;var s,o;return{startState:function(){s=s||e.getMode(t,n.scriptingModeSpec);o=o||e.getMode(t,"htmlmixed");return{token:n.startOpen?a:u,htmlState:e.startState(o),scriptState:e.startState(s)}},token:function(e,t){return t.token(e,t)},indent:function(e,t){if(e.token==u)return o.indent(e.htmlState,t);else if(s.indent)return s.indent(e.scriptState,t)},copyState:function(t){return{token:t.token,htmlState:e.copyState(o,t.htmlState),scriptState:e.copyState(s,t.scriptState)}},innerMode:function(e){if(e.token==a)return{state:e.scriptState,mode:s};else return{state:e.htmlState,mode:o}}}},"htmlmixed");e.defineMIME("application/x-ejs",{name:"htmlembedded",scriptingModeSpec:"javascript"});e.defineMIME("application/x-aspx",{name:"htmlembedded",scriptingModeSpec:"text/x-csharp"});e.defineMIME("application/x-jsp",{name:"htmlembedded",scriptingModeSpec:"text/x-java"});e.defineMIME("application/x-erb",{name:"htmlembedded",scriptingModeSpec:"ruby"})})