if(jQuery)(function(){$.extend($.fn,{contextMenu:function(e,t){if(e.menu==undefined)return false;if(e.inSpeed==undefined)e.inSpeed=150;if(e.outSpeed==undefined)e.outSpeed=75;if(e.inSpeed==0)e.inSpeed=-1;if(e.outSpeed==0)e.outSpeed=-1;$(this).each(function(){var n=$(this);var r=$(n).offset();$("#"+e.menu).addClass("contextMenu");$(this).mousedown(function(i){var s=i;s.stopPropagation();$(this).mouseup(function(i){i.stopPropagation();var u=$(this);$(this).unbind("mouseup");if(s.button==2){$(".contextMenu").hide();var a=$("#"+e.menu);if($(n).hasClass("disabled"))return false;var f={},l,c;if(self.innerHeight){f.pageYOffset=self.pageYOffset;f.pageXOffset=self.pageXOffset;f.innerHeight=self.innerHeight;f.innerWidth=self.innerWidth}else if(document.documentElement&&document.documentElement.clientHeight){f.pageYOffset=document.documentElement.scrollTop;f.pageXOffset=document.documentElement.scrollLeft;f.innerHeight=document.documentElement.clientHeight;f.innerWidth=document.documentElement.clientWidth}else if(document.body){f.pageYOffset=document.body.scrollTop;f.pageXOffset=document.body.scrollLeft;f.innerHeight=document.body.clientHeight;f.innerWidth=document.body.clientWidth}i.pageX?l=i.pageX:l=i.clientX+f.scrollLeft;i.pageY?c=i.pageY:c=i.clientY+f.scrollTop;$(document).unbind("click");$(a).css({top:c,left:l}).fadeIn(e.inSpeed);$(a).find("A").mouseover(function(){$(a).find("LI.hover").removeClass("hover");$(this).parent().addClass("hover")}).mouseout(function(){$(a).find("LI.hover").removeClass("hover")});$(document).keypress(function(e){switch(e.keyCode){case 38:if($(a).find("LI.hover").size()==0){$(a).find("LI:last").addClass("hover")}else{$(a).find("LI.hover").removeClass("hover").prevAll("LI:not(.disabled)").eq(0).addClass("hover");if($(a).find("LI.hover").size()==0)$(a).find("LI:last").addClass("hover")}break;case 40:if($(a).find("LI.hover").size()==0){$(a).find("LI:first").addClass("hover")}else{$(a).find("LI.hover").removeClass("hover").nextAll("LI:not(.disabled)").eq(0).addClass("hover");if($(a).find("LI.hover").size()==0)$(a).find("LI:first").addClass("hover")}break;case 13:$(a).find("LI.hover A").trigger("click");break;case 27:$(document).trigger("click");break}});$("#"+e.menu).find("A").unbind("click");$("#"+e.menu).find("LI:not(.disabled) A").click(function(){$(document).unbind("click").unbind("keypress");$(".contextMenu").hide();if(t)t($(this).attr("href").substr(1),$(u),{x:l-r.left,y:c-r.top,docX:l,docY:c});return false});setTimeout(function(){$(document).click(function(){$(document).unbind("click").unbind("keypress");$(a).fadeOut(e.outSpeed);return false})},0)}})});if($.browser.mozilla){$("#"+e.menu).each(function(){$(this).css({MozUserSelect:"none"})})}else if($.browser.msie){$("#"+e.menu).each(function(){$(this).bind("selectstart.disableTextSelect",function(){return false})})}else{$("#"+e.menu).each(function(){$(this).bind("mousedown.disableTextSelect",function(){return false})})}$(n).add($("UL.contextMenu")).bind("contextmenu",function(){return false})});return $(this)},disableContextMenuItems:function(e){if(e==undefined){$(this).find("LI").addClass("disabled");return $(this)}$(this).each(function(){if(e!=undefined){var t=e.split(",");for(var n=0;n<t.length;n++){$(this).find('A[href="'+t[n]+'"]').parent().addClass("disabled")}}});return $(this)},enableContextMenuItems:function(e){if(e==undefined){$(this).find("LI.disabled").removeClass("disabled");return $(this)}$(this).each(function(){if(e!=undefined){var t=e.split(",");for(var n=0;n<t.length;n++){$(this).find('A[href="'+t[n]+'"]').parent().removeClass("disabled")}}});return $(this)},disableContextMenu:function(){$(this).each(function(){$(this).addClass("disabled")});return $(this)},enableContextMenu:function(){$(this).each(function(){$(this).removeClass("disabled")});return $(this)},destroyContextMenu:function(){$(this).each(function(){$(this).unbind("mousedown").unbind("mouseup")});return $(this)}})})(jQuery)